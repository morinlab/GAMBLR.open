<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Genetic classification of tumours • GAMBLR.open</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="genetic_classification_files/libs/quarto-html/popper.min.js"></script><script src="genetic_classification_files/libs/quarto-html/tippy.umd.min.js"></script><link href="genetic_classification_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="genetic_classification_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Genetic classification of tumours">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.open</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/GAMBLR-open.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/glossary.html">GAMBLR terms and concepts</a></li>
    <li><a class="dropdown-item" href="../articles/mutation_summary.html">Exploring simple somatic mutations</a></li>
    <li><a class="dropdown-item" href="../articles/feature_matrix.html">Summarizing mutation status as a feature matrix</a></li>
    <li><a class="dropdown-item" href="../articles/genetic_classification.html">Genetic classification of tumours</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Genetic classification of tumours</h1>





      <div class="d-none name"><code></code></div>
    </div>






    <p>In another tutorial, we saw at how GAMBLR.open can be used to generate binary matrices representing the presence/absence of mutations and other genetic features (e.g. common CNVs, SVs). In this tutorial, we will review how the binary matrix generation can be utilized to classify samples according to different classification systems and tumour labels can be inferred to assign tumours into genetic subgroups.</p>
<div>
<blockquote>
<p><strong>Tip</strong></p>
<p>We would not need to assemble the matrix separately - the <code>classify_</code> family of GAMBLR functions will directly support the maf/seg/bedpe data and handle matrix construction for you.</p>
</blockquote>
</div>
<p>The GAMBLR contains <a href="https://github.com/morinlab/GAMBLR.predict" class="external-link">a collection of trained models</a> and functions to pre-format inputs for these models. It contains classifiers of <a href="https://doi.org/10.1182/blood.2022016534" class="external-link">Burkitt</a> and <a href="https://doi.org/10.1182/blood.2022018719" class="external-link">Follicular</a> lymphomas originally published, as well as reproduced of DLBCL classification by the groupings of <a href="https://doi.org/10.1038/s41591-018-0016-8" class="external-link">Chapuy et al</a>, <a href="https://doi.org/10.1182/blood.2019003535" class="external-link">Lacy et al</a>, and <a href="https://doi.org/10.1111/bjh.17132" class="external-link">Runge et al</a>.</p>
<section class="level2"><h2 id="load-packages-and-data">Load packages and data<a class="anchor" aria-label="anchor" href="#load-packages-and-data"></a>
</h2>
<p>First, we will load required packages. Only <code>GAMBLR.open</code> and <code>tidyverse</code> are needed - they both will load for you all required functionality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR.open</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<p>Next, we will obtain the data. We would need the metadata, SSM in maf format, CNV in seg format, and SV in bedped format. For the demonstration purposes, we will use the data bundled with GAMBLR to show the classification functionality. Here, we will subset data to a small number of samples and will illustrate the required formatting and minimal required information.</p>
<section class="level3"><h3 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>The metadata is a data frame which contains the column <code>sample_id</code> listing sample ids for tumours to be classified, and column <code>pathology</code> which will dictate sliding threshold for aSHM site annotation when necessary. The column <code>seq_type</code> is not required for classification purposes, but will be kept in this tutorial for the purpose of subsequent retreival of mutation data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load metadata</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_gambl_metadata.html">get_gambl_metadata</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seq_type</span> <span class="op">==</span> <span class="st">"genome"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="st">"DLBCL"</span>, <span class="st">"BL"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="va">ungroup</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">study</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DLBCL_Arthur"</span>, <span class="st">"DLBCL_Thomas"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">pathology</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">pathology</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BL</td>
<td style="text-align: right;">234</td>
</tr>
<tr class="even">
<td style="text-align: left;">DLBCL</td>
<td style="text-align: right;">334</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FL</td>
<td style="text-align: right;">219</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Demonstrate the required columns in metadata</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">pathology</span>, <span class="va">seq_type</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pathology</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">seq_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: left;">DLBCL</td>
<td style="text-align: left;">genome</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-14595_tumorD</td>
<td style="text-align: left;">FL</td>
<td style="text-align: left;">genome</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: left;">DLBCL</td>
<td style="text-align: left;">genome</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: left;">DLBCL</td>
<td style="text-align: left;">genome</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: left;">DLBCL</td>
<td style="text-align: left;">genome</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: left;">DLBCL</td>
<td style="text-align: left;">genome</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3"><h3 id="ssm-maf-format">SSM (maf format)<a class="anchor" aria-label="anchor" href="#ssm-maf-format"></a>
</h3>
<p>The key data to be provided for the genetic subgroup classification is SSM in maf format. Only a small subset of columns is required to be used as input information, and here we would demonstrate the expected format and minimal required information for SSM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ssm_by_samples.html">get_ssm_by_samples</a></span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">as.data.frame</span></span>
<span></span>
<span><span class="co"># Only these columns are required</span></span>
<span><span class="va">maf_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Hugo_Symbol"</span>, <span class="st">"NCBI_Build"</span>,</span>
<span>    <span class="st">"Chromosome"</span>, <span class="st">"Start_Position"</span>, <span class="st">"End_Position"</span>,</span>
<span>    <span class="st">"Variant_Classification"</span>, <span class="st">"HGVSp_Short"</span>,</span>
<span>    <span class="st">"Tumor_Sample_Barcode"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="va">maf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">maf_columns</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">maf</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Hugo_Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NCBI_Build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Chromosome</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Start_Position</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">End_Position</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variant_Classification</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">HGVSp_Short</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Tumor_Sample_Barcode</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TNFRSF14</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">2488139</td>
<td style="text-align: right;">2488139</td>
<td style="text-align: left;">Nonsense_Mutation</td>
<td style="text-align: left;">p.W12*</td>
<td style="text-align: left;">01-20260T</td>
</tr>
<tr class="even">
<td style="text-align: left;">SPEN</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">16245921</td>
<td style="text-align: right;">16245921</td>
<td style="text-align: left;">Missense_Mutation</td>
<td style="text-align: left;">p.P515R</td>
<td style="text-align: left;">01-20260T</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRINP3</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">190187637</td>
<td style="text-align: right;">190187637</td>
<td style="text-align: left;">Intron</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">01-20260T</td>
</tr>
<tr class="even">
<td style="text-align: left;">BRINP3</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">190189661</td>
<td style="text-align: right;">190189661</td>
<td style="text-align: left;">Intron</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">01-20260T</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRINP3</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">190264257</td>
<td style="text-align: right;">190264257</td>
<td style="text-align: left;">Intron</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">01-20260T</td>
</tr>
<tr class="even">
<td style="text-align: left;">BTG2</td>
<td style="text-align: left;">GRCh37</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">203274977</td>
<td style="text-align: right;">203274977</td>
<td style="text-align: left;">Intron</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">01-20260T</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3"><h3 id="cnv-seg-format">CNV (seg format)<a class="anchor" aria-label="anchor" href="#cnv-seg-format"></a>
</h3>
<p>Several classifiers (<a href="https://doi.org/10.1038/s41591-018-0016-8" class="external-link">Chapuy et al</a>, <a href="https://doi.org/10.1182/blood.2019003535" class="external-link">Lacy et al</a>, and <a href="https://doi.org/10.1111/bjh.17132" class="external-link">Runge et al</a>) require a CNV information to be provided, and here we would demonstrate the expected format and minimal required information for CNV in standard seg format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cn_segments.html">get_cn_segments</a></span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">as.data.frame</span></span>
<span></span>
<span><span class="co"># Only these columns are required</span></span>
<span><span class="va">seg_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ID"</span>, <span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"LOH_flag"</span>, <span class="st">"log.ratio"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">seg</span> <span class="op">&lt;-</span> <span class="va">seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">seg_columns</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">seg</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">chrom</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">start</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">end</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LOH_flag</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">log.ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">10001</td>
<td style="text-align: right;">762600</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">762601</td>
<td style="text-align: right;">121500000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">142600000</td>
<td style="text-align: right;">161506889</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">161506890</td>
<td style="text-align: right;">161652716</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">161652717</td>
<td style="text-align: right;">162110568</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.7279926</td>
</tr>
<tr class="even">
<td style="text-align: left;">02-13135T</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">162110569</td>
<td style="text-align: right;">162111399</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3"><h3 id="sv-bedpe-format">SV (bedpe format)<a class="anchor" aria-label="anchor" href="#sv-bedpe-format"></a>
</h3>
<p>Several classifiers require SV data to be provided, and here we would demonstrate the expected format and minimal required information for SV in standard bed format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bedpe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_manta_sv.html">get_manta_sv</a></span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="va">as.data.frame</span></span>
<span></span>
<span><span class="co"># Only these columns are required</span></span>
<span><span class="va">bedpe_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">bedpe</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span></span>
<span></span>
<span><span class="va">bedpe</span> <span class="op">&lt;-</span> <span class="va">bedpe</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">bedpe_columns</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bedpe</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">CHROM_A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">START_A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">END_A</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CHROM_B</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">START_B</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">END_B</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">manta_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SCORE</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">STRAND_A</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">STRAND_B</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">tumour_sample_id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">161658631</td>
<td style="text-align: right;">161658631</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">16509907</td>
<td style="text-align: right;">16509907</td>
<td style="text-align: left;">MantaBND:21171:0:1:0:0:0</td>
<td style="text-align: right;">133</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">FL2002T1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">161663959</td>
<td style="text-align: right;">161663959</td>
<td style="text-align: left;">9</td>
<td style="text-align: right;">37363320</td>
<td style="text-align: right;">37363320</td>
<td style="text-align: left;">MantaBND:206628:0:1:0:0:0</td>
<td style="text-align: right;">122</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">09-15842_tumorA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">161663959</td>
<td style="text-align: right;">161663959</td>
<td style="text-align: left;">9</td>
<td style="text-align: right;">37363320</td>
<td style="text-align: right;">37363320</td>
<td style="text-align: left;">MantaBND:195941:0:1:0:0:0</td>
<td style="text-align: right;">151</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">09-15842_tumorB</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">65267283</td>
<td style="text-align: right;">65267283</td>
<td style="text-align: left;">14</td>
<td style="text-align: right;">106110907</td>
<td style="text-align: right;">106110907</td>
<td style="text-align: left;">MantaBND:152220:0:1:0:0:0:0</td>
<td style="text-align: right;">88</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">15-38154T</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">65267422</td>
<td style="text-align: right;">65267422</td>
<td style="text-align: left;">14</td>
<td style="text-align: right;">106110905</td>
<td style="text-align: right;">106110905</td>
<td style="text-align: left;">MantaBND:152220:0:1:0:0:0:0</td>
<td style="text-align: right;">135</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">15-38154T</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: right;">91976545</td>
<td style="text-align: right;">91976545</td>
<td style="text-align: left;">14</td>
<td style="text-align: right;">106211857</td>
<td style="text-align: right;">106211857</td>
<td style="text-align: left;">MantaBND:18:59794:59817:0:1:0</td>
<td style="text-align: right;">90</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">+</td>
<td style="text-align: left;">15-31924T</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<blockquote>
<p><strong>Note</strong></p>
<p>The column <code>manta_name</code> can be any other column from the tool of choice that generated bedpe output and reports the unique id of the SV event, and is expected to be unique for the SV event.</p>
</blockquote>
</div>
</section></section><section class="level2"><h2 id="classify-dlbcl">Classify DLBCL<a class="anchor" aria-label="anchor" href="#classify-dlbcl"></a>
</h2>
<p>Here, we will explore the reproduced DLBCL classification by the groupings of <a href="https://doi.org/10.1038/s41591-018-0016-8" class="external-link">Chapuy et al</a>, <a href="https://doi.org/10.1182/blood.2019003535" class="external-link">Lacy et al</a>, and <a href="https://doi.org/10.1111/bjh.17132" class="external-link">Runge et al</a>. The classification algorithm can be easily controlled by switching the argument <code>method</code> of the <code>classify_dlbcl()</code> function.</p>
<div>
<blockquote>
<p><strong>Important</strong></p>
<p>The DLBCL classifiers were not released with the publications, and the models provided here are the best attempt on reproducing the original models. While the model described by Chapuy et al is reproduced with &gt; 92% accuracy, the Lacy and HMRN classifier results need to be taken with caution as the accuracy of the bundled model is only 80%.</p>
</blockquote>
</div>
<section class="level3"><h3 id="chapuy-et-al--c0-c5-clusters">Chapuy et al. (C0-C5 clusters)<a class="anchor" aria-label="anchor" href="#chapuy-et-al--c0-c5-clusters"></a>
</h3>
<p>The paper published originally in 2018 by <a href="https://doi.org/10.1038/s41591-018-0016-8" class="external-link">Chapuy et al</a> was the first attempt to use systematic approach and classify DLBCL patients into genetic subgroupings using genomic information.</p>
<div>
<blockquote>
<p><strong>Note</strong></p>
<p>This model classifies tumours according to the original 2018 publication, and is not directly related to the 2024 DLBCLass model.</p>
</blockquote>
</div>
<p>Here is how these subgroupings can be recapitulated with GAMBLR functionality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"DLBCL"</span><span class="op">)</span>,</span>
<span>    maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>    seg_data <span class="op">=</span> <span class="va">seg</span>,</span>
<span>    sv_data <span class="op">=</span> <span class="va">bedpe</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>The <code>classify_</code> family of functions by default return both the assembled matrix and predictions. The model reports the confidence of each tumour’s subgoup vote, as well as final label.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assembled matrix</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACTB</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">B2M</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL11A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subgroup assignment</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C0</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">C5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Chapuy_cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1060348</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5110284</td>
<td style="text-align: right;">0.2784030</td>
<td style="text-align: right;">0.1045338</td>
<td style="text-align: left;">C3</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0931391</td>
<td style="text-align: right;">0.0386996</td>
<td style="text-align: right;">0.1889158</td>
<td style="text-align: right;">0.3859610</td>
<td style="text-align: right;">0.2932845</td>
<td style="text-align: left;">C4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2842088</td>
<td style="text-align: right;">0.0914615</td>
<td style="text-align: right;">0.1265154</td>
<td style="text-align: right;">0.0730396</td>
<td style="text-align: right;">0.4247747</td>
<td style="text-align: left;">C5</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0797927</td>
<td style="text-align: right;">0.0670896</td>
<td style="text-align: right;">0.0457110</td>
<td style="text-align: right;">0.1034915</td>
<td style="text-align: right;">0.7039151</td>
<td style="text-align: left;">C5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.1152963</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3449964</td>
<td style="text-align: right;">0.5397073</td>
<td style="text-align: left;">C5</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.4723915</td>
<td style="text-align: right;">0.0275195</td>
<td style="text-align: right;">0.1548457</td>
<td style="text-align: right;">0.2401450</td>
<td style="text-align: right;">0.1050982</td>
<td style="text-align: left;">C1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-14774_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5192447</td>
<td style="text-align: right;">0.0050716</td>
<td style="text-align: right;">0.0872477</td>
<td style="text-align: right;">0.3039748</td>
<td style="text-align: right;">0.0844612</td>
<td style="text-align: left;">C1</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-16433_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8286825</td>
<td style="text-align: right;">0.1713175</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: left;">C3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-16433_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2873270</td>
<td style="text-align: right;">0.2551277</td>
<td style="text-align: right;">0.2676392</td>
<td style="text-align: right;">0.1094943</td>
<td style="text-align: right;">0.0804118</td>
<td style="text-align: left;">C1</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-23117_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2100450</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0463066</td>
<td style="text-align: right;">0.2689441</td>
<td style="text-align: right;">0.4747043</td>
<td style="text-align: left;">C5</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span>, <span class="va">Chapuy_cluster</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Chapuy_cluster</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">C1</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C2</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">C3</td>
<td style="text-align: right;">124</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C4</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="even">
<td style="text-align: left;">C5</td>
<td style="text-align: right;">74</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3"><h3 id="lacy-et-al-">Lacy et al.<a class="anchor" aria-label="anchor" href="#lacy-et-al-"></a>
</h3>
<p>The paper published originally in 2020 by <a href="https://doi.org/10.1182/blood.2019003535" class="external-link">Lacy et al</a> did not release the classification algorithm, but we recapitulated it by training random forest model with 80% accuaracy. Here is how these subgroupings can be recapitulated with GAMBLR functionality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"DLBCL"</span><span class="op">)</span>,</span>
<span>    maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>    seg_data <span class="op">=</span> <span class="va">seg</span>,</span>
<span>    sv_data <span class="op">=</span> <span class="va">bedpe</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"lacy"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Similar to the Chapuy et al predictions, we can see both the constructed matrix and the confidence of each tumour’s subgoup vote, as well as final label.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assembled matrix</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL11A_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MALT1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">REL_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">XPO1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CD58_OR_del</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subgroup assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MYD88</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NOTCH2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Other</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SOCS1/SGK1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TET2/SGK1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Lacy_cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0.220</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: left;">NOTCH2</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: left;">Other</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.754</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: left;">MYD88</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.398</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span>, <span class="va">Lacy_cluster</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Lacy_cluster</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BCL2</td>
<td style="text-align: right;">110</td>
</tr>
<tr class="even">
<td style="text-align: left;">MYD88</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOTCH2</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOCS1/SGK1</td>
<td style="text-align: right;">81</td>
</tr>
<tr class="even">
<td style="text-align: left;">TET2/SGK1</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level3"><h3 id="hmrn">HMRN<a class="anchor" aria-label="anchor" href="#hmrn"></a>
</h3>
<p>The paper published by <a href="https://doi.org/10.1111/bjh.17132" class="external-link">Runge et al</a> modified the original Lacy et al. subgoupings to more closely adhere the genetic subgroups to the <a href="https://doi.org/10.1016/j.ccell.2020.03.015" class="external-link">LymphGen</a> classification system. The difference between the Runge and Lacy methods is that tumours with truncating <em>NOTCH1</em> mutation will be assigned to a separate subgrouping category regardless of other genetic alterations present in the same tumour sample. Here is how these subgroupings can be recapitulated with GAMBLR functionality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"DLBCL"</span><span class="op">)</span>,</span>
<span>    maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>    seg_data <span class="op">=</span> <span class="va">seg</span>,</span>
<span>    sv_data <span class="op">=</span> <span class="va">bedpe</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"hmrn"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Take a look at the resulting output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assembled matrix</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL11A_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MALT1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">REL_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">XPO1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CD58_OR_del</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL11A_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MALT1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">REL_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">XPO1_amp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CD58_OR_del</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subgroup assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MYD88</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NOTCH2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Other</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SOCS1/SGK1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">TET2/SGK1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NOTCH1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">hmrn_cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0.220</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NOTCH1</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Other</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.754</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.162</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">MYD88</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.398</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">SOCS1/SGK1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span>, <span class="va">hmrn_cluster</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">hmrn_cluster</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BCL2</td>
<td style="text-align: right;">110</td>
</tr>
<tr class="even">
<td style="text-align: left;">MYD88</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOTCH1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">NOTCH2</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOCS1/SGK1</td>
<td style="text-align: right;">81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TET2/SGK1</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section class="level2"><h2 id="classify-fl">Classify FL<a class="anchor" aria-label="anchor" href="#classify-fl"></a>
</h2>
<p>Here, we will explore the classification of FL tumours into genetic subgroups with differential propensity for transformation as originally described <a href="https://doi.org/10.1182/blood.2022018719" class="external-link">here</a>. The developed model can be easily accessed with <code>classify_fl()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_fl</span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span>  <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FL"</span>, <span class="st">"DLBCL"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    maf_data <span class="op">=</span> <span class="va">maf</span>,</span>
<span>    output <span class="op">=</span> <span class="st">"both"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Similar to DLBCL classifier, we can take a look at the assembled matrix, as well as at the predictions and the confidence of each tumour’s vote:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assembled matrix</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ACTB</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ARID1A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ATP6AP1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ATP6V1B2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">B2M</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-14595_tumorD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-16433_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-16433_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subgroup assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cFL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dFL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">is_cFL</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.948</td>
<td style="text-align: left;">dFL</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-14595_tumorD</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.962</td>
<td style="text-align: left;">dFL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">dFL</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.922</td>
<td style="text-align: left;">dFL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.982</td>
<td style="text-align: left;">dFL</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: left;">dFL</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span>, <span class="va">is_cFL</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">is_cFL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cFL</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: left;">dFL</td>
<td style="text-align: right;">510</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level2"><h2 id="classify-bl">Classify BL<a class="anchor" aria-label="anchor" href="#classify-bl"></a>
</h2>
<p>Here, we will explore the classification of BL tumours into genetic subgroups as originally described in <a href="https://doi.org/10.1182/blood.2022016534" class="external-link">Thomas et al</a>. The developed model reported in this study can be easily accessed with <code>classify_bl()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_bl</span><span class="op">(</span></span>
<span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span>  <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BL"</span>, <span class="st">"DLBCL"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    maf_data <span class="op">=</span> <span class="va">maf</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>Similar to other classifiers, we can take a look at the assembled matrix, as well as at the predictions and the confidence of each tumour’s vote:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assembled matrix</span></span>
<span><span class="va">predictions</span><span class="op">$</span><span class="va">matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ARID1A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">B2M</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL10</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL11A</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BCL2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-14774_tumorB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-16433_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01-16433_tumorB</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-23117_tumorA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subgroup assignment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span><span class="op">)</span> </span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">sample_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DGG-BL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DLBCL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">IC-BL</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q53-BL</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BL_subgroup</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">DLBCL</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: left;">DLBCL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: right;">0.296</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: left;">DLBCL</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-26427_tumorA</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.964</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">DLBCL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-26427_tumorC</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">DLBCL</td>
</tr>
<tr class="even">
<td style="text-align: left;">01-14774_tumorA</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.894</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: left;">DLBCL</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">$</span><span class="va">predictions</span>, <span class="va">BL_subgroup</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">BL_subgroup</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DGG-BL</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="even">
<td style="text-align: left;">DLBCL</td>
<td style="text-align: right;">345</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IC-BL</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q53-BL</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>That’s it!</p>
<p><em>Happy GAMBLing!</em></p>
<pre><code>  /$$$$$$     /$$$$$$    /$$      /$$   /$$$$$$$    /$$        .:::::::
 /$$__  $$   /$$__  $$  | $$$    /$$$  | $$__  $$  | $$        .::    .::
| $$  \__/  | $$  \ $$  | $$$$  /$$$$  | $$  \ $$  | $$        .::    .::
| $$ /$$$$  | $$$$$$$$  | $$ $$/$$ $$  | $$$$$$$   | $$   &lt;-   .: .::
| $$|_  $$  | $$__  $$  | $$  $$$| $$  | $$__  $$  | $$        .::  .::
| $$  \ $$  | $$  | $$  | $$\  $ | $$  | $$  \ $$  | $$        .::    .::
|  $$$$$$/  | $$  | $$  | $$ \/  | $$  | $$$$$$$/  | $$$$$$$$  .::      .::
 \______/   |__/  |__/  |__/     |__/  |_______/   |________/
 ~GENOMIC~~~~~~~~~~~~~OF~~~~~~~~~~~~~~~~~B-CELL~~~~~~~~~~~~~~~~~~IN~~~~~~
 ~~~~~~~~~~~~ANALYSIS~~~~~~MATURE~~~~~~~~~~~~~~~~~~~LYMPHOMAS~~~~~~~~~~R~ </code></pre>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Morin, Kostia Dreval.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
